# Пример конфигурационного файла
# Скопируйте этот файл в .env и заполните своими значениями

# ===== НАСТРОЙКИ ПРИЛОЖЕНИЯ =====
APP_NAME="Scalping Trading Bot"
APP_VERSION="1.0.0"
DEBUG=True
LOG_LEVEL=INFO

# ===== БЕЗОПАСНОСТЬ =====
# Секретный ключ для JWT токенов (сгенерируйте случайную строку)
# Используйте: openssl rand -hex 32
SECRET_KEY=VLTnCEHktMBFXqvj4adU7zDRSyGQlPAw

# Алгоритм шифрования JWT
ALGORITHM=HS256

# Время жизни токена доступа в минутах
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# Пароль для входа в приложение (хешируется автоматически)
APP_PASSWORD=robocop89

# ===== НАСТРОЙКИ BYBIT API =====
# Режим работы: testnet или mainnet
BYBIT_MODE=mainnet

# API ключи для Bybit Testnet
BYBIT_API_KEY=9iAjXdXhFoa5ANtb0G
BYBIT_API_SECRET=H7unSmXrTcL1j7uAyeUWvCOs1nujJTNBfZGV

# API ключи для Bybit Mainnet (используются только если BYBIT_MODE=mainnet)
BYBIT_MAINNET_API_KEY=9iAjXdXhFoa5ANtb0G
BYBIT_MAINNET_API_SECRET=H7unSmXrTcL1j7uAyeUWvCOs1nujJTNBfZGV

# ===== ТОРГОВЫЕ НАСТРОЙКИ =====
# Торговые пары через запятую (без пробелов)
TRADING_PAIRS=BTCUSDT,ETHUSDT,SOLUSDT

# Максимальное количество пар на одно WebSocket соединение
MAX_PAIRS_PER_CONNECTION=10

# Глубина стакана (50, 200, 500)
ORDERBOOK_DEPTH=200

# ===== НАСТРОЙКИ СТРАТЕГИИ =====
# Порог дисбаланса для генерации сигнала на покупку (0.0-1.0)
IMBALANCE_BUY_THRESHOLD=0.75

# Порог дисбаланса для генерации сигнала на продажу (0.0-1.0)
IMBALANCE_SELL_THRESHOLD=0.25

# Минимальный объем для анализа кластера
MIN_CLUSTER_VOLUME=10000

# ===== НАСТРОЙКИ РИСК-МЕНЕДЖМЕНТА =====
# Максимальное количество открытых позиций одновременно
MAX_OPEN_POSITIONS=5

# Максимальная экспозиция в USDT
MAX_EXPOSURE_USDT=10000

# Минимальный размер ордера в USDT
MIN_ORDER_SIZE_USDT=5

# ===== НАСТРОЙКИ API СЕРВЕРА =====
# Хост и порт для FastAPI сервера
API_HOST=0.0.0.0
API_PORT=8000

# CORS разрешенные источники (через запятую)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# ===== НАСТРОЙКИ WEBSOCKET =====
# Таймаут переподключения в секундах
WS_RECONNECT_TIMEOUT=5

# Максимальное количество попыток переподключения
WS_MAX_RECONNECT_ATTEMPTS=10

# Интервал ping-pong в секундах
WS_PING_INTERVAL=20

# ========================================
# DATABASE (PostgreSQL + TimescaleDB)
# ========================================
# Формат: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://trading_bot:robocop@localhost:5432/trading_bot

# Database pool настройки
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_ECHO=false

# ========================================
# REDIS (для будущего использования)
# ========================================
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0

# ========================================
# RATE LIMITING
# ========================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REST_PUBLIC=120
RATE_LIMIT_REST_PRIVATE=120
RATE_LIMIT_REST_TRADE=100
RATE_LIMIT_ORDER_PLACEMENT=50

# ========================================
# CIRCUIT BREAKER
# ========================================
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_COOLDOWN_SECONDS=60

# ========================================
# IDEMPOTENCY
# ========================================
IDEMPOTENCY_TTL_MINUTES=60

# ========================================
# RECOVERY & RECONCILIATION
# ========================================
AUTO_RECONCILE_ON_STARTUP=true
RECONCILE_INTERVAL_MINUTES=60

# ========================================
# ТОРГОВЫЕ НАСТРОЙКИ И РИСКИ
# ========================================

MAX_POSITION_SIZE_USDT=1000.0

IMBALANCE_THRESHOLD=0.7

# ========================================
# WEBSOCKET НАСТРОЙКИ
# ========================================

WS_RECONNECT_DELAY=5
# ==================== ML CONFIGURATION ====================
ML_SERVER_URL=http://localhost:8001
ML_MIN_CONFIDENCE=0.6
ML_WEIGHT=0.6
STRATEGY_WEIGHT=0.4

# ==================== STRATEGY CONFIGURATION ====================
# Режимы консенсуса: weighted, majority, unanimous
CONSENSUS_MODE=weighted
MIN_STRATEGIES=2
MIN_CONSENSUS_CONFIDENCE=0.6

# ==================== DETECTION CONFIGURATION ====================
SPOOFING_DETECTION_ENABLED=true
LAYERING_DETECTION_ENABLED=true
SR_DETECTION_ENABLED=true

# ==================== RECOVERY SERVICE ====================

# Таймаут для обнаружения зависших ордеров (в минутах)
# Ордер считается зависшим если находится в PENDING/PLACED дольше этого времени
HANGING_ORDER_TIMEOUT_MINUTES=30

# Автоматическое восстановление после краша
# true - выполнять recover_from_crash() при старте
ENABLE_AUTO_RECOVERY=true

# Проверка зависших ордеров при сверке
ENABLE_HANGING_ORDER_CHECK=true

# Автоматическое восстановление FSM при старте
ENABLE_FSM_AUTO_RESTORE=true

# Максимальное количество попыток сверки с биржей
MAX_RECONCILIATION_RETRIES=3

# Задержка между попытками сверки (секунды)
RECONCILIATION_RETRY_DELAY=2

# Детальное логирование зависших ордеров
DETAILED_HANGING_ORDER_LOGGING=true


# ==================== SCREENER SETTINGS ====================
# Настройки скринера торговых пар

# Bybit WebSocket URL для тикеров (публичный endpoint)
BYBIT_WS_URL=wss://stream.bybit.com/v5/public/linear

# Минимальный объем за 24ч для отображения в скринере (USDT)
SCREENER_MIN_VOLUME=4000000.0

# Максимальное количество пар в скринере
SCREENER_MAX_PAIRS=200

# Интервал broadcast данных скринера (секунды)
SCREENER_BROADCAST_INTERVAL=2.0

# Интервал очистки неактивных пар (секунды)
SCREENER_CLEANUP_INTERVAL=60

# TTL для неактивных пар (секунды)
SCREENER_INACTIVE_TTL=300

# Включение/отключение скринера
SCREENER_ENABLED=True

# Логирование статистики скринера (каждые N секунд)
SCREENER_STATS_LOG_INTERVAL=60

# ==================== DYNAMIC SYMBOLS SETTINGS ====================
# Динамическое управление списком торговых пар

# Включить динамическое управление (True/False)
DYNAMIC_SYMBOLS_ENABLED=True

# Минимальный объем за 24ч для фильтра (USDT)
DYNAMIC_MIN_VOLUME=4000000.0

# Максимум пар после фильтра по объему
DYNAMIC_MAX_VOLUME_PAIRS=200

# Количество растущих пар (топ по приросту)
DYNAMIC_TOP_GAINERS=25

# Количество падающих пар (топ по падению)
DYNAMIC_TOP_LOSERS=10

# Интервал обновления списка (секунды)
DYNAMIC_REFRESH_INTERVAL=180

# ==================== LEVERAGE CONFIGURATION ====================
DEFAULT_LEVERAGE=10
MAX_LEVERAGE=50