[2025-10-11 15:57:11.536] [ERROR   ] [database.connection      ] [initialize:71] Ошибка подключения к БД: No module named 'asyncpg'
[2025-10-11 15:57:11.536] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: No module named 'asyncpg'
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 29, in init_database
    await db_manager.initialize()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 45, in initialize
    self.engine = create_async_engine(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 120, in create_async_engine
    sync_engine = _create_engine(url, **kw)
  File "<string>", line 2, in create_engine
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 617, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 1094, in import_dbapi
    return AsyncAdapt_asyncpg_dbapi(__import__("asyncpg"))
ModuleNotFoundError: No module named 'asyncpg'
[2025-10-11 15:58:45.505] [ERROR   ] [database.connection      ] [initialize:71] Ошибка подключения к БД: No module named 'asyncpg'
[2025-10-11 15:58:45.505] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: No module named 'asyncpg'
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 29, in init_database
    await db_manager.initialize()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 45, in initialize
    self.engine = create_async_engine(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 120, in create_async_engine
    sync_engine = _create_engine(url, **kw)
  File "<string>", line 2, in create_engine
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 617, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 1094, in import_dbapi
    return AsyncAdapt_asyncpg_dbapi(__import__("asyncpg"))
ModuleNotFoundError: No module named 'asyncpg'
[2025-10-11 15:59:11.856] [ERROR   ] [database.connection      ] [initialize:71] Ошибка подключения к БД: Invalid argument(s) 'pool_size','max_overflow' sent to create_engine(), using configuration PGDialect_asyncpg/NullPool/Engine.  Please check that the keyword arguments are appropriate for this combination of components.
[2025-10-11 15:59:11.856] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: Invalid argument(s) 'pool_size','max_overflow' sent to create_engine(), using configuration PGDialect_asyncpg/NullPool/Engine.  Please check that the keyword arguments are appropriate for this combination of components.
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 29, in init_database
    await db_manager.initialize()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 45, in initialize
    self.engine = create_async_engine(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 120, in create_async_engine
    sync_engine = _create_engine(url, **kw)
  File "<string>", line 2, in create_engine
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 715, in create_engine
    raise TypeError(
TypeError: Invalid argument(s) 'pool_size','max_overflow' sent to create_engine(), using configuration PGDialect_asyncpg/NullPool/Engine.  Please check that the keyword arguments are appropriate for this combination of components.
[2025-10-11 16:01:34.149] [ERROR   ] [database.connection      ] [create_tables:104] Ошибка создания таблиц: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:01:34.150] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 494, in finish_recv
    return ov.getresult()
OSError: [WinError 64] Указанное сетевое имя более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 826, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 498, in finish_recv
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] Указанное сетевое имя более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 33, in init_database
    await db_manager.create_tables()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 96, in create_tables
    await conn.execute(text("CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE"))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 659, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:06:35.443] [ERROR   ] [database.connection      ] [create_tables:104] Ошибка создания таблиц: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:06:35.443] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 494, in finish_recv
    return ov.getresult()
OSError: [WinError 64] Указанное сетевое имя более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 826, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 498, in finish_recv
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] Указанное сетевое имя более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 33, in init_database
    await db_manager.create_tables()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 96, in create_tables
    await conn.execute(text("CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE"))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 659, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:09:10.239] [ERROR   ] [database.connection      ] [create_tables:104] Ошибка создания таблиц: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:09:10.239] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 494, in finish_recv
    return ov.getresult()
OSError: [WinError 64] Указанное сетевое имя более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 826, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 498, in finish_recv
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] Указанное сетевое имя более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 33, in init_database
    await db_manager.create_tables()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 96, in create_tables
    await conn.execute(text("CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE"))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 659, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 19:08:05.244] [ERROR   ] [__main__                 ] [init_database:79] Ошибка инициализации БД: Textual SQL expression '\n                SELECT t...' should be explicitly declared as text('\n                SELECT t...')
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 50, in init_database
    result = await session.execute("""
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2147, in _execute_internal
    statement = coercions.expect(roles.StatementRole, statement)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 395, in expect
    resolved = impl._literal_coercion(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 621, in _literal_coercion
    return self._text_coercion(element, argname, **kw)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 614, in _text_coercion
    return _no_text_coercion(element, argname)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 584, in _no_text_coercion
    raise exc_cls(
sqlalchemy.exc.ArgumentError: Textual SQL expression '\n                SELECT t...' should be explicitly declared as text('\n                SELECT t...')
[2025-10-11 19:08:28.013] [ERROR   ] [__main__                 ] [check_async_connection:90]   ✗ Ошибка асинхронного подключения: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
[2025-10-11 19:08:28.015] [ERROR   ] [__main__                 ] [diagnose:232] ✗ ОБНАРУЖЕНЫ ПРОБЛЕМЫ!
[2025-10-11 19:09:31.637] [ERROR   ] [__main__                 ] [check_async_connection:90]   ✗ Ошибка асинхронного подключения: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
[2025-10-11 19:09:31.640] [ERROR   ] [__main__                 ] [diagnose:232] ✗ ОБНАРУЖЕНЫ ПРОБЛЕМЫ!
[2025-10-11 19:13:23.616] [ERROR   ] [__main__                 ] [check_connection:128] Ошибка подключения: Textual SQL expression 'SELECT version()' should be explicitly declared as text('SELECT version()')
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 95, in check_connection
    result = await session.execute("SELECT version()")
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2147, in _execute_internal
    statement = coercions.expect(roles.StatementRole, statement)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 395, in expect
    resolved = impl._literal_coercion(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 621, in _literal_coercion
    return self._text_coercion(element, argname, **kw)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 614, in _text_coercion
    return _no_text_coercion(element, argname)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 584, in _no_text_coercion
    raise exc_cls(
sqlalchemy.exc.ArgumentError: Textual SQL expression 'SELECT version()' should be explicitly declared as text('SELECT version()')
