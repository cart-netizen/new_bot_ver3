[2025-10-11 15:57:11.511] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 15:57:11.511] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 15:57:11.511] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 15:57:11.511] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 15:57:11.511] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 15:57:11.511] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 15:57:11.520] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 15:57:11.520] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 15:57:11.520] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 15:57:11.520] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 15:57:11.520] [INFO    ] [database.connection      ] [initialize:42] Инициализация подключения к PostgreSQL...
[2025-10-11 15:57:11.536] [ERROR   ] [database.connection      ] [initialize:71] Ошибка подключения к БД: No module named 'asyncpg'
[2025-10-11 15:57:11.536] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: No module named 'asyncpg'
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 29, in init_database
    await db_manager.initialize()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 45, in initialize
    self.engine = create_async_engine(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 120, in create_async_engine
    sync_engine = _create_engine(url, **kw)
  File "<string>", line 2, in create_engine
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 617, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 1094, in import_dbapi
    return AsyncAdapt_asyncpg_dbapi(__import__("asyncpg"))
ModuleNotFoundError: No module named 'asyncpg'
[2025-10-11 15:58:45.480] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 15:58:45.481] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 15:58:45.481] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 15:58:45.481] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 15:58:45.481] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 15:58:45.481] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 15:58:45.481] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 15:58:45.482] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 15:58:45.482] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 15:58:45.482] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 15:58:45.482] [INFO    ] [database.connection      ] [initialize:42] Инициализация подключения к PostgreSQL...
[2025-10-11 15:58:45.505] [ERROR   ] [database.connection      ] [initialize:71] Ошибка подключения к БД: No module named 'asyncpg'
[2025-10-11 15:58:45.505] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: No module named 'asyncpg'
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 29, in init_database
    await db_manager.initialize()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 45, in initialize
    self.engine = create_async_engine(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 120, in create_async_engine
    sync_engine = _create_engine(url, **kw)
  File "<string>", line 2, in create_engine
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 617, in create_engine
    dbapi = dbapi_meth(**dbapi_args)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 1094, in import_dbapi
    return AsyncAdapt_asyncpg_dbapi(__import__("asyncpg"))
ModuleNotFoundError: No module named 'asyncpg'
[2025-10-11 15:59:11.808] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 15:59:11.808] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 15:59:11.808] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 15:59:11.808] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 15:59:11.808] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 15:59:11.808] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 15:59:11.808] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 15:59:11.808] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 15:59:11.808] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 15:59:11.808] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 15:59:11.808] [INFO    ] [database.connection      ] [initialize:42] Инициализация подключения к PostgreSQL...
[2025-10-11 15:59:11.856] [ERROR   ] [database.connection      ] [initialize:71] Ошибка подключения к БД: Invalid argument(s) 'pool_size','max_overflow' sent to create_engine(), using configuration PGDialect_asyncpg/NullPool/Engine.  Please check that the keyword arguments are appropriate for this combination of components.
[2025-10-11 15:59:11.856] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: Invalid argument(s) 'pool_size','max_overflow' sent to create_engine(), using configuration PGDialect_asyncpg/NullPool/Engine.  Please check that the keyword arguments are appropriate for this combination of components.
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 29, in init_database
    await db_manager.initialize()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 45, in initialize
    self.engine = create_async_engine(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 120, in create_async_engine
    sync_engine = _create_engine(url, **kw)
  File "<string>", line 2, in create_engine
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\deprecations.py", line 281, in warned
    return fn(*args, **kwargs)  # type: ignore[no-any-return]
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 715, in create_engine
    raise TypeError(
TypeError: Invalid argument(s) 'pool_size','max_overflow' sent to create_engine(), using configuration PGDialect_asyncpg/NullPool/Engine.  Please check that the keyword arguments are appropriate for this combination of components.
[2025-10-11 16:01:34.012] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 16:01:34.012] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 16:01:34.012] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 16:01:34.012] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 16:01:34.012] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 16:01:34.012] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 16:01:34.012] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 16:01:34.013] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 16:01:34.013] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 16:01:34.013] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 16:01:34.013] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 16:01:34.094] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 16:01:34.094] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:01:34.095] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 16:01:34.096] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:01:34.096] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 16:01:34.096] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:01:34.097] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:01:34.097] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 16:01:34.098] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00021s] ()
[2025-10-11 16:01:34.098] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 16:01:34.100] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 16:01:34.100] [INFO    ] [__main__                 ] [init_database:30] ✓ Подключение к БД установлено
[2025-10-11 16:01:34.100] [INFO    ] [database.connection      ] [create_tables:92] Создание таблиц в БД...
[2025-10-11 16:01:34.138] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:01:34.139] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE
[2025-10-11 16:01:34.139] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00038s] ()
[2025-10-11 16:01:34.149] [ERROR   ] [database.connection      ] [create_tables:104] Ошибка создания таблиц: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:01:34.150] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 494, in finish_recv
    return ov.getresult()
OSError: [WinError 64] Указанное сетевое имя более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 826, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 498, in finish_recv
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] Указанное сетевое имя более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 33, in init_database
    await db_manager.create_tables()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 96, in create_tables
    await conn.execute(text("CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE"))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 659, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:01:34.155] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 16:01:34.155] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 16:06:35.299] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 16:06:35.299] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 16:06:35.299] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 16:06:35.299] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 16:06:35.299] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 16:06:35.299] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 16:06:35.299] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 16:06:35.299] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 16:06:35.299] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 16:06:35.299] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 16:06:35.299] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 16:06:35.392] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 16:06:35.392] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00018s] ()
[2025-10-11 16:06:35.399] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 16:06:35.399] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 16:06:35.399] [INFO    ] [__main__                 ] [init_database:30] ✓ Подключение к БД установлено
[2025-10-11 16:06:35.399] [INFO    ] [database.connection      ] [create_tables:92] Создание таблиц в БД...
[2025-10-11 16:06:35.439] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:06:35.439] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE
[2025-10-11 16:06:35.439] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00023s] ()
[2025-10-11 16:06:35.443] [ERROR   ] [database.connection      ] [create_tables:104] Ошибка создания таблиц: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:06:35.443] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 494, in finish_recv
    return ov.getresult()
OSError: [WinError 64] Указанное сетевое имя более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 826, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 498, in finish_recv
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] Указанное сетевое имя более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 33, in init_database
    await db_manager.create_tables()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 96, in create_tables
    await conn.execute(text("CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE"))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 659, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:06:35.457] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 16:06:35.457] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 16:09:10.092] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 16:09:10.092] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 16:09:10.092] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 16:09:10.092] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 16:09:10.092] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 16:09:10.092] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 16:09:10.092] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 16:09:10.092] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 16:09:10.092] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 16:09:10.092] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 16:09:10.092] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00019s] ()
[2025-10-11 16:09:10.170] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 16:09:10.170] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 16:09:10.170] [INFO    ] [__main__                 ] [init_database:30] ✓ Подключение к БД установлено
[2025-10-11 16:09:10.170] [INFO    ] [database.connection      ] [create_tables:92] Создание таблиц в БД...
[2025-10-11 16:09:10.217] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:09:10.217] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE
[2025-10-11 16:09:10.217] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00022s] ()
[2025-10-11 16:09:10.239] [ERROR   ] [database.connection      ] [create_tables:104] Ошибка создания таблиц: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:09:10.239] [ERROR   ] [__main__                 ] [init_database:50] Ошибка инициализации БД: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 494, in finish_recv
    return ov.getresult()
OSError: [WinError 64] Указанное сетевое имя более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 826, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\1q\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 498, in finish_recv
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] Указанное сетевое имя более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 33, in init_database
    await db_manager.create_tables()
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\database\connection.py", line 96, in create_tables
    await conn.execute(text("CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE"))
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 659, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.ConnectionDoesNotExistError'>: connection was closed in the middle of operation
[SQL: CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
[2025-10-11 16:09:10.244] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 16:09:10.244] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 16:24:30.034] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 16:24:30.034] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 16:24:30.034] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 16:24:30.034] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 16:24:30.034] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 16:24:30.034] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 16:24:30.034] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 16:24:30.042] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 16:24:30.042] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 16:24:30.042] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 16:24:30.042] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00018s] ()
[2025-10-11 16:24:30.122] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 16:24:30.134] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 16:24:30.134] [INFO    ] [__main__                 ] [init_database:30] ✓ Подключение к БД установлено
[2025-10-11 16:24:30.134] [INFO    ] [database.connection      ] [create_tables:92] Создание таблиц в БД...
[2025-10-11 16:24:30.177] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 16:24:30.177] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE
[2025-10-11 16:24:30.177] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00026s] ()
[2025-10-11 16:24:30.279] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 16:24:30.295] [INFO    ] [database.connection      ] [create_tables:101] ✓ Таблицы созданы успешно
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:34] ✓ Таблицы созданы
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:36] ================================================================================
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:37] БАЗА ДАННЫХ УСПЕШНО ИНИЦИАЛИЗИРОВАНА
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:38] ================================================================================
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:41] 
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:42] Для управления миграциями используйте Alembic:
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:43]   alembic upgrade head     # Применить все миграции
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:44]   alembic downgrade -1     # Откатить последнюю миграцию
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:45]   alembic current          # Текущая версия
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:46]   alembic history          # История миграций
[2025-10-11 16:24:30.295] [INFO    ] [__main__                 ] [init_database:47] 
[2025-10-11 16:24:30.295] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 16:24:30.295] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 19:00:58.350] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 19:00:58.350] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 19:00:58.350] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 19:00:58.350] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 19:00:58.350] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 19:00:58.351] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 19:00:58.351] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 19:00:58.351] [INFO    ] [__main__                 ] [init_database:23] ================================================================================
[2025-10-11 19:00:58.351] [INFO    ] [__main__                 ] [init_database:24] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 19:00:58.351] [INFO    ] [__main__                 ] [init_database:25] ================================================================================
[2025-10-11 19:00:58.351] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00017s] ()
[2025-10-11 19:00:58.429] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:00:58.429] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 19:00:58.429] [INFO    ] [__main__                 ] [init_database:30] ✓ Подключение к БД установлено
[2025-10-11 19:00:58.429] [INFO    ] [database.connection      ] [create_tables:92] Создание таблиц в БД...
[2025-10-11 19:00:58.476] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:00:58.476] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE
[2025-10-11 19:00:58.476] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00041s] ()
[2025-10-11 19:00:58.493] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:00:58.495] [INFO    ] [database.connection      ] [create_tables:101] ✓ Таблицы созданы успешно
[2025-10-11 19:00:58.495] [INFO    ] [__main__                 ] [init_database:34] ✓ Таблицы созданы
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:36] ================================================================================
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:37] БАЗА ДАННЫХ УСПЕШНО ИНИЦИАЛИЗИРОВАНА
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:38] ================================================================================
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:41] 
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:42] Для управления миграциями используйте Alembic:
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:43]   alembic upgrade head     # Применить все миграции
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:44]   alembic downgrade -1     # Откатить последнюю миграцию
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:45]   alembic current          # Текущая версия
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:46]   alembic history          # История миграций
[2025-10-11 19:00:58.496] [INFO    ] [__main__                 ] [init_database:47] 
[2025-10-11 19:00:58.496] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 19:00:58.497] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 19:08:05.043] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 19:08:05.043] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 19:08:05.043] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 19:08:05.043] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 19:08:05.043] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 19:08:05.043] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 19:08:05.043] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 19:08:05.043] [INFO    ] [__main__                 ] [init_database:34] ================================================================================
[2025-10-11 19:08:05.043] [INFO    ] [__main__                 ] [init_database:35] ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 19:08:05.043] [INFO    ] [__main__                 ] [init_database:36] ================================================================================
[2025-10-11 19:08:05.043] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 19:08:05.106] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 19:08:05.106] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:08:05.106] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 19:08:05.106] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:08:05.106] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 19:08:05.106] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:08:05.121] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:08:05.121] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 19:08:05.121] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00018s] ()
[2025-10-11 19:08:05.121] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:08:05.121] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 19:08:05.121] [INFO    ] [__main__                 ] [init_database:41] ✓ Подключение к БД установлено
[2025-10-11 19:08:05.121] [INFO    ] [database.connection      ] [create_tables:92] Создание таблиц в БД...
[2025-10-11 19:08:05.152] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:08:05.152] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE
[2025-10-11 19:08:05.152] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00023s] ()
[2025-10-11 19:08:05.152] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
[2025-10-11 19:08:05.152] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00034s] ('orders', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.003372s ago] ('positions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.004162s ago] ('trades', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.004893s ago] ('audit_logs', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.005612s ago] ('idempotency_cache', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.006284s ago] ('market_data_snapshots', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00026s] ('orderside', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE TYPE orderside AS ENUM ('BUY', 'SELL')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00019s] ()
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.003325s ago] ('ordertype', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE TYPE ordertype AS ENUM ('MARKET', 'LIMIT')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00019s] ()
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.005257s ago] ('orderstatus', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE TYPE orderstatus AS ENUM ('PENDING', 'PLACED', 'PARTIALLY_FILLED', 'FILLED', 'CANCELLED', 'REJECTED', 'FAILED')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00019s] ()
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.007159s ago] ('positionstatus', 'pg_catalog')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE TYPE positionstatus AS ENUM ('OPENING', 'OPEN', 'CLOSING', 'CLOSED')
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00018s] ()
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
[2025-10-11 19:08:05.168] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.008951s ago] ('auditaction', 'pg_catalog')
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE TYPE auditaction AS ENUM ('ORDER_PLACE', 'ORDER_CANCEL', 'ORDER_MODIFY', 'POSITION_OPEN', 'POSITION_CLOSE', 'POSITION_MODIFY', 'BALANCE_UPDATE', 'CONFIG_CHANGE')
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
CREATE TABLE positions (
	id UUID NOT NULL, 
	symbol VARCHAR(20) NOT NULL, 
	side orderside NOT NULL, 
	status positionstatus NOT NULL, 
	quantity FLOAT NOT NULL, 
	entry_price FLOAT NOT NULL, 
	exit_price FLOAT, 
	current_price FLOAT, 
	stop_loss FLOAT, 
	take_profit FLOAT, 
	trailing_stop FLOAT, 
	unrealized_pnl FLOAT, 
	realized_pnl FLOAT, 
	opened_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	closed_at TIMESTAMP WITHOUT TIME ZONE, 
	updated_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	entry_signal JSONB, 
	exit_signal JSONB, 
	entry_market_data JSONB, 
	exit_market_data JSONB, 
	entry_indicators JSONB, 
	exit_indicators JSONB, 
	entry_reason TEXT, 
	exit_reason TEXT, 
	version INTEGER NOT NULL, 
	metadata_json JSONB, 
	PRIMARY KEY (id)
)


[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00085s] ()
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_positions_symbol_status ON positions (symbol, status)
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00025s] ()
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_positions_opened_at ON positions (opened_at)
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00022s] ()
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_positions_opened_at ON positions (opened_at)
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00019s] ()
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_positions_symbol ON positions (symbol)
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00018s] ()
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_positions_status ON positions (status)
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00018s] ()
[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
CREATE TABLE audit_logs (
	id UUID NOT NULL, 
	action auditaction NOT NULL, 
	entity_type VARCHAR(50) NOT NULL, 
	entity_id VARCHAR(100) NOT NULL, 
	old_value JSONB, 
	new_value JSONB, 
	changes JSONB, 
	reason TEXT, 
	user_id VARCHAR(100), 
	trace_id VARCHAR(100), 
	success BOOLEAN NOT NULL, 
	error_message TEXT, 
	timestamp TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	context JSONB, 
	PRIMARY KEY (id)
)


[2025-10-11 19:08:05.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00036s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_audit_logs_trace_id ON audit_logs (trace_id)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00021s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_audit_logs_timestamp ON audit_logs (timestamp)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_audit_entity ON audit_logs (entity_type, entity_id)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_audit_action_timestamp ON audit_logs (action, timestamp)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_audit_logs_action ON audit_logs (action)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
CREATE TABLE idempotency_cache (
	id UUID NOT NULL, 
	idempotency_key VARCHAR(200) NOT NULL, 
	operation VARCHAR(100) NOT NULL, 
	result JSONB, 
	success BOOLEAN NOT NULL, 
	error TEXT, 
	created_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	expires_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	PRIMARY KEY (id)
)


[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00038s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE UNIQUE INDEX ix_idempotency_cache_idempotency_key ON idempotency_cache (idempotency_key)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00021s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_idempotency_cache_created_at ON idempotency_cache (created_at)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_idempotency_key_created ON idempotency_cache (idempotency_key, created_at)
[2025-10-11 19:08:05.199] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00021s] ()
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_idempotency_cache_expires_at ON idempotency_cache (expires_at)
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00022s] ()
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
CREATE TABLE market_data_snapshots (
	id UUID NOT NULL, 
	symbol VARCHAR(20) NOT NULL, 
	timestamp TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	best_bid FLOAT, 
	best_ask FLOAT, 
	mid_price FLOAT, 
	bid_volume FLOAT, 
	ask_volume FLOAT, 
	imbalance FLOAT, 
	spread FLOAT, 
	orderbook JSONB, 
	metrics JSONB, 
	PRIMARY KEY (id)
)


[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00059s] ()
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_market_data_snapshots_symbol ON market_data_snapshots (symbol)
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00022s] ()
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_market_symbol_timestamp ON market_data_snapshots (symbol, timestamp)
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_market_data_snapshots_timestamp ON market_data_snapshots (timestamp)
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.216] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
CREATE TABLE orders (
	id UUID NOT NULL, 
	client_order_id VARCHAR(100) NOT NULL, 
	exchange_order_id VARCHAR(100), 
	symbol VARCHAR(20) NOT NULL, 
	side orderside NOT NULL, 
	order_type ordertype NOT NULL, 
	status orderstatus NOT NULL, 
	quantity FLOAT NOT NULL, 
	price FLOAT, 
	filled_quantity FLOAT, 
	average_fill_price FLOAT, 
	stop_loss FLOAT, 
	take_profit FLOAT, 
	created_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	placed_at TIMESTAMP WITHOUT TIME ZONE, 
	filled_at TIMESTAMP WITHOUT TIME ZONE, 
	cancelled_at TIMESTAMP WITHOUT TIME ZONE, 
	updated_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	signal_data JSONB, 
	market_data JSONB, 
	indicators JSONB, 
	reason TEXT, 
	position_id UUID, 
	version INTEGER NOT NULL, 
	metadata_json JSONB, 
	PRIMARY KEY (id), 
	FOREIGN KEY(position_id) REFERENCES positions (id)
)


[2025-10-11 19:08:05.226] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00063s] ()
[2025-10-11 19:08:05.226] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_orders_symbol ON orders (symbol)
[2025-10-11 19:08:05.226] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00025s] ()
[2025-10-11 19:08:05.231] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE UNIQUE INDEX ix_orders_client_order_id ON orders (client_order_id)
[2025-10-11 19:08:05.231] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00030s] ()
[2025-10-11 19:08:05.232] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_orders_symbol_status ON orders (symbol, status)
[2025-10-11 19:08:05.233] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00025s] ()
[2025-10-11 19:08:05.235] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE UNIQUE INDEX ix_orders_exchange_order_id ON orders (exchange_order_id)
[2025-10-11 19:08:05.235] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00026s] ()
[2025-10-11 19:08:05.237] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_orders_created_at ON orders (created_at)
[2025-10-11 19:08:05.237] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00023s] ()
[2025-10-11 19:08:05.238] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_orders_status ON orders (status)
[2025-10-11 19:08:05.238] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00021s] ()
[2025-10-11 19:08:05.239] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_orders_created_at ON orders (created_at)
[2025-10-11 19:08:05.240] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00018s] ()
[2025-10-11 19:08:05.242] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
CREATE TABLE trades (
	id UUID NOT NULL, 
	order_id UUID NOT NULL, 
	position_id UUID, 
	symbol VARCHAR(20) NOT NULL, 
	side orderside NOT NULL, 
	quantity FLOAT NOT NULL, 
	price FLOAT NOT NULL, 
	commission FLOAT, 
	executed_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, 
	exchange_trade_id VARCHAR(100), 
	metadata_json JSONB, 
	PRIMARY KEY (id), 
	FOREIGN KEY(order_id) REFERENCES orders (id), 
	FOREIGN KEY(position_id) REFERENCES positions (id)
)


[2025-10-11 19:08:05.243] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00064s] ()
[2025-10-11 19:08:05.244] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX idx_trades_symbol_executed ON trades (symbol, executed_at)
[2025-10-11 19:08:05.244] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00025s] ()
[2025-10-11 19:08:05.244] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_trades_executed_at ON trades (executed_at)
[2025-10-11 19:08:05.244] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00021s] ()
[2025-10-11 19:08:05.244] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE INDEX ix_trades_symbol ON trades (symbol)
[2025-10-11 19:08:05.244] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [no key 0.00020s] ()
[2025-10-11 19:08:05.244] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:08:05.244] [INFO    ] [database.connection      ] [create_tables:101] ✓ Таблицы созданы успешно
[2025-10-11 19:08:05.244] [INFO    ] [__main__                 ] [init_database:45] ✓ Таблицы созданы
[2025-10-11 19:08:05.244] [ERROR   ] [__main__                 ] [init_database:79] Ошибка инициализации БД: Textual SQL expression '\n                SELECT t...' should be explicitly declared as text('\n                SELECT t...')
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 50, in init_database
    result = await session.execute("""
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2147, in _execute_internal
    statement = coercions.expect(roles.StatementRole, statement)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 395, in expect
    resolved = impl._literal_coercion(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 621, in _literal_coercion
    return self._text_coercion(element, argname, **kw)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 614, in _text_coercion
    return _no_text_coercion(element, argname)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 584, in _no_text_coercion
    raise exc_cls(
sqlalchemy.exc.ArgumentError: Textual SQL expression '\n                SELECT t...' should be explicitly declared as text('\n                SELECT t...')
[2025-10-11 19:08:05.256] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 19:08:05.256] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 19:08:27.697] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 19:08:27.697] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 19:08:27.697] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 19:08:27.697] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 19:08:27.697] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 19:08:27.697] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 19:08:27.698] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 19:08:27.698] [INFO    ] [__main__                 ] [diagnose:185] ================================================================================
[2025-10-11 19:08:27.698] [INFO    ] [__main__                 ] [diagnose:186] ДИАГНОСТИКА СИСТЕМЫ БАЗЫ ДАННЫХ
[2025-10-11 19:08:27.698] [INFO    ] [__main__                 ] [diagnose:187] ================================================================================
[2025-10-11 19:08:27.698] [INFO    ] [__main__                 ] [check_imports:22] Проверка импортов...
[2025-10-11 19:08:27.778] [INFO    ] [__main__                 ] [check_imports:35]   ✓ SQLAlchemy установлен
[2025-10-11 19:08:27.803] [INFO    ] [__main__                 ] [check_imports:35]   ✓ AsyncPG установлен
[2025-10-11 19:08:27.808] [INFO    ] [__main__                 ] [check_imports:35]   ✓ Psycopg2 установлен
[2025-10-11 19:08:27.878] [INFO    ] [__main__                 ] [check_imports:35]   ✓ Alembic установлен
[2025-10-11 19:08:27.879] [INFO    ] [__main__                 ] [check_database_url:45] Проверка DATABASE_URL...
[2025-10-11 19:08:27.879] [INFO    ] [__main__                 ] [check_database_url:50]   URL: postgresql+asyncpg://trading_b...
[2025-10-11 19:08:27.879] [INFO    ] [__main__                 ] [check_database_url:59]   ✓ Драйвер: asyncpg
[2025-10-11 19:08:27.879] [INFO    ] [__main__                 ] [check_database_url:60]   ✓ Пользователь: trading_bot
[2025-10-11 19:08:27.879] [INFO    ] [__main__                 ] [check_database_url:61]   ✓ Хост: localhost
[2025-10-11 19:08:27.879] [INFO    ] [__main__                 ] [check_database_url:62]   ✓ Порт: 5432
[2025-10-11 19:08:27.880] [INFO    ] [__main__                 ] [check_database_url:63]   ✓ База данных: trading_bot
[2025-10-11 19:08:27.880] [INFO    ] [__main__                 ] [check_models:146] Проверка моделей...
[2025-10-11 19:08:27.930] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель orders зарегистрирована
[2025-10-11 19:08:27.931] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель positions зарегистрирована
[2025-10-11 19:08:27.931] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель trades зарегистрирована
[2025-10-11 19:08:27.931] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель audit_logs зарегистрирована
[2025-10-11 19:08:27.931] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель idempotency_cache зарегистрирована
[2025-10-11 19:08:27.931] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель market_data_snapshots зарегистрирована
[2025-10-11 19:08:27.931] [INFO    ] [__main__                 ] [check_sync_connection:98] Проверка синхронного подключения...
[2025-10-11 19:08:27.960] [INFO    ] [__main__                 ] [check_sync_connection:129]   ✓ Синхронное подключение работает
[2025-10-11 19:08:27.961] [INFO    ] [__main__                 ] [check_async_connection:76] Проверка асинхронного подключения...
[2025-10-11 19:08:27.961] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 19:08:28.006] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 19:08:28.007] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:08:28.008] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 19:08:28.008] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:08:28.009] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 19:08:28.009] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:08:28.009] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:08:28.010] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 19:08:28.010] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00019s] ()
[2025-10-11 19:08:28.011] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:08:28.012] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 19:08:28.013] [ERROR   ] [__main__                 ] [check_async_connection:90]   ✗ Ошибка асинхронного подключения: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:211] ================================================================================
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:212] РЕЗУЛЬТАТЫ ДИАГНОСТИКИ:
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:213] ================================================================================
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:218]   Импорты: ✓ OK
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:218]   DATABASE_URL: ✓ OK
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:218]   Модели: ✓ OK
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:218]   Синхронное подключение: ✓ OK
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:218]   Асинхронное подключение: ✗ ОШИБКА
[2025-10-11 19:08:28.015] [INFO    ] [__main__                 ] [diagnose:222] ================================================================================
[2025-10-11 19:08:28.015] [ERROR   ] [__main__                 ] [diagnose:232] ✗ ОБНАРУЖЕНЫ ПРОБЛЕМЫ!
[2025-10-11 19:08:28.016] [INFO    ] [__main__                 ] [diagnose:233] 
[2025-10-11 19:08:28.016] [INFO    ] [__main__                 ] [diagnose:234] Рекомендации:
[2025-10-11 19:08:28.016] [INFO    ] [__main__                 ] [diagnose:235]   1. Проверьте, что PostgreSQL запущен
[2025-10-11 19:08:28.016] [INFO    ] [__main__                 ] [diagnose:236]   2. Проверьте правильность DATABASE_URL в .env
[2025-10-11 19:08:28.016] [INFO    ] [__main__                 ] [diagnose:237]   3. Установите недостающие зависимости: pip install -r requirements.txt
[2025-10-11 19:08:28.016] [INFO    ] [__main__                 ] [diagnose:238]   4. Используйте синхронную версию инициализации: python backend/scripts/sync_init_database.py init
[2025-10-11 19:09:31.319] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 19:09:31.319] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 19:09:31.319] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 19:09:31.319] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 19:09:31.319] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 19:09:31.319] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 19:09:31.319] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 19:09:31.319] [INFO    ] [__main__                 ] [diagnose:185] ================================================================================
[2025-10-11 19:09:31.319] [INFO    ] [__main__                 ] [diagnose:186] ДИАГНОСТИКА СИСТЕМЫ БАЗЫ ДАННЫХ
[2025-10-11 19:09:31.319] [INFO    ] [__main__                 ] [diagnose:187] ================================================================================
[2025-10-11 19:09:31.319] [INFO    ] [__main__                 ] [check_imports:22] Проверка импортов...
[2025-10-11 19:09:31.398] [INFO    ] [__main__                 ] [check_imports:35]   ✓ SQLAlchemy установлен
[2025-10-11 19:09:31.433] [INFO    ] [__main__                 ] [check_imports:35]   ✓ AsyncPG установлен
[2025-10-11 19:09:31.433] [INFO    ] [__main__                 ] [check_imports:35]   ✓ Psycopg2 установлен
[2025-10-11 19:09:31.492] [INFO    ] [__main__                 ] [check_imports:35]   ✓ Alembic установлен
[2025-10-11 19:09:31.492] [INFO    ] [__main__                 ] [check_database_url:45] Проверка DATABASE_URL...
[2025-10-11 19:09:31.492] [INFO    ] [__main__                 ] [check_database_url:50]   URL: postgresql+asyncpg://trading_b...
[2025-10-11 19:09:31.492] [INFO    ] [__main__                 ] [check_database_url:59]   ✓ Драйвер: asyncpg
[2025-10-11 19:09:31.492] [INFO    ] [__main__                 ] [check_database_url:60]   ✓ Пользователь: trading_bot
[2025-10-11 19:09:31.492] [INFO    ] [__main__                 ] [check_database_url:61]   ✓ Хост: localhost
[2025-10-11 19:09:31.492] [INFO    ] [__main__                 ] [check_database_url:62]   ✓ Порт: 5432
[2025-10-11 19:09:31.508] [INFO    ] [__main__                 ] [check_database_url:63]   ✓ База данных: trading_bot
[2025-10-11 19:09:31.508] [INFO    ] [__main__                 ] [check_models:146] Проверка моделей...
[2025-10-11 19:09:31.556] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель orders зарегистрирована
[2025-10-11 19:09:31.556] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель positions зарегистрирована
[2025-10-11 19:09:31.556] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель trades зарегистрирована
[2025-10-11 19:09:31.556] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель audit_logs зарегистрирована
[2025-10-11 19:09:31.556] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель idempotency_cache зарегистрирована
[2025-10-11 19:09:31.556] [INFO    ] [__main__                 ] [check_models:172]   ✓ Модель market_data_snapshots зарегистрирована
[2025-10-11 19:09:31.556] [INFO    ] [__main__                 ] [check_sync_connection:98] Проверка синхронного подключения...
[2025-10-11 19:09:31.572] [INFO    ] [__main__                 ] [check_sync_connection:129]   ✓ Синхронное подключение работает
[2025-10-11 19:09:31.572] [INFO    ] [__main__                 ] [check_async_connection:76] Проверка асинхронного подключения...
[2025-10-11 19:09:31.572] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 19:09:31.629] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 19:09:31.629] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:09:31.630] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 19:09:31.631] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:09:31.631] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 19:09:31.631] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:09:31.633] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:09:31.633] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 19:09:31.633] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00019s] ()
[2025-10-11 19:09:31.634] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:09:31.637] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 19:09:31.637] [ERROR   ] [__main__                 ] [check_async_connection:90]   ✗ Ошибка асинхронного подключения: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:211] ================================================================================
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:212] РЕЗУЛЬТАТЫ ДИАГНОСТИКИ:
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:213] ================================================================================
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:218]   Импорты: ✓ OK
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:218]   DATABASE_URL: ✓ OK
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:218]   Модели: ✓ OK
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:218]   Синхронное подключение: ✓ OK
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:218]   Асинхронное подключение: ✗ ОШИБКА
[2025-10-11 19:09:31.638] [INFO    ] [__main__                 ] [diagnose:222] ================================================================================
[2025-10-11 19:09:31.640] [ERROR   ] [__main__                 ] [diagnose:232] ✗ ОБНАРУЖЕНЫ ПРОБЛЕМЫ!
[2025-10-11 19:09:31.640] [INFO    ] [__main__                 ] [diagnose:233] 
[2025-10-11 19:09:31.640] [INFO    ] [__main__                 ] [diagnose:234] Рекомендации:
[2025-10-11 19:09:31.640] [INFO    ] [__main__                 ] [diagnose:235]   1. Проверьте, что PostgreSQL запущен
[2025-10-11 19:09:31.640] [INFO    ] [__main__                 ] [diagnose:236]   2. Проверьте правильность DATABASE_URL в .env
[2025-10-11 19:09:31.640] [INFO    ] [__main__                 ] [diagnose:237]   3. Установите недостающие зависимости: pip install -r requirements.txt
[2025-10-11 19:09:31.640] [INFO    ] [__main__                 ] [diagnose:238]   4. Используйте синхронную версию инициализации: python backend/scripts/sync_init_database.py init
[2025-10-11 19:09:51.325] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 19:09:51.325] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 19:09:51.325] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 19:09:51.325] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 19:09:51.325] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 19:09:51.326] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 19:09:51.326] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 19:09:51.326] [INFO    ] [__main__                 ] [init_database:96] ================================================================================
[2025-10-11 19:09:51.327] [INFO    ] [__main__                 ] [init_database:97] СИНХРОННАЯ ИНИЦИАЛИЗАЦИЯ БАЗЫ ДАННЫХ
[2025-10-11 19:09:51.327] [INFO    ] [__main__                 ] [init_database:98] ================================================================================
[2025-10-11 19:09:51.355] [INFO    ] [__main__                 ] [create_database_if_not_exists:83] ✓ База данных 'trading_bot' уже существует
[2025-10-11 19:09:51.487] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 19:09:51.487] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] {}
[2025-10-11 19:09:51.488] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 19:09:51.488] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] {}
[2025-10-11 19:09:51.489] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 19:09:51.489] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] {}
[2025-10-11 19:09:51.490] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:09:51.490] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 19:09:51.490] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00035s] {}
[2025-10-11 19:09:51.490] [INFO    ] [__main__                 ] [init_database:116] ✓ Подключение к БД установлено
[2025-10-11 19:09:51.490] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE
[2025-10-11 19:09:51.490] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00017s] {}
[2025-10-11 19:09:51.491] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:09:51.492] [INFO    ] [__main__                 ] [init_database:122] ✓ TimescaleDB расширение установлено
[2025-10-11 19:09:51.492] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:09:51.494] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.495] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00029s] {'table_name': 'orders', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.496] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.496] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.001577s ago] {'table_name': 'positions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.496] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.497] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.002398s ago] {'table_name': 'trades', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.497] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.498] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.003199s ago] {'table_name': 'audit_logs', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.498] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.499] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.004243s ago] {'table_name': 'idempotency_cache', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.499] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.499] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.005108s ago] {'table_name': 'market_data_snapshots', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.522] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.523] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00079s] {'typname_1': 'orderside', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.524] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.525] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.002422s ago] {'typname_1': 'ordertype', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.526] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.526] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.003885s ago] {'typname_1': 'orderstatus', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.527] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.527] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.005175s ago] {'typname_1': 'positionstatus', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.528] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
[2025-10-11 19:09:51.529] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 0.006217s ago] {'typname_1': 'auditaction', 'nspname_1': 'pg_catalog'}
[2025-10-11 19:09:51.529] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:09:51.529] [INFO    ] [__main__                 ] [init_database:128] ✓ Таблицы созданы
[2025-10-11 19:09:51.530] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:09:51.530] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
                SELECT tablename 
                FROM pg_tables 
                WHERE schemaname = 'public' 
                ORDER BY tablename
            
[2025-10-11 19:09:51.530] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00044s] {}
[2025-10-11 19:09:51.531] [INFO    ] [__main__                 ] [init_database:141] Созданные таблицы:
[2025-10-11 19:09:51.531] [INFO    ] [__main__                 ] [init_database:143]   - audit_logs
[2025-10-11 19:09:51.531] [INFO    ] [__main__                 ] [init_database:143]   - idempotency_cache
[2025-10-11 19:09:51.531] [INFO    ] [__main__                 ] [init_database:143]   - market_data_snapshots
[2025-10-11 19:09:51.532] [INFO    ] [__main__                 ] [init_database:143]   - orders
[2025-10-11 19:09:51.532] [INFO    ] [__main__                 ] [init_database:143]   - positions
[2025-10-11 19:09:51.532] [INFO    ] [__main__                 ] [init_database:143]   - trades
[2025-10-11 19:09:51.532] [INFO    ] [sqlalchemy.engine.Engine ] [_rollback_impl:1126] ROLLBACK
[2025-10-11 19:09:51.532] [INFO    ] [__main__                 ] [init_database:147] ================================================================================
[2025-10-11 19:09:51.532] [INFO    ] [__main__                 ] [init_database:148] БАЗА ДАННЫХ УСПЕШНО ИНИЦИАЛИЗИРОВАНА
[2025-10-11 19:09:51.532] [INFO    ] [__main__                 ] [init_database:149] ================================================================================
[2025-10-11 19:09:51.533] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:09:51.533] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] 
                CREATE TABLE IF NOT EXISTS alembic_version (
                    version_num VARCHAR(32) NOT NULL,
                    CONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)
                )
            
[2025-10-11 19:09:51.533] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00042s] {}
[2025-10-11 19:09:51.536] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:09:51.537] [INFO    ] [__main__                 ] [init_database:160] ✓ Таблица alembic_version создана
[2025-10-11 19:12:18.868] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 19:12:18.868] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 19:12:18.868] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 19:12:18.868] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 19:12:18.868] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 19:12:18.868] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 19:12:18.868] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 19:12:18.868] [INFO    ] [__main__                 ] [check_database:202] Проверка базы данных...
[2025-10-11 19:12:18.900] [INFO    ] [__main__                 ] [check_database:212] PostgreSQL: PostgreSQL 16.9, compiled by Visual C++ build 1944...
[2025-10-11 19:12:18.900] [INFO    ] [__main__                 ] [check_database:222] TimescaleDB: v2.21.2
[2025-10-11 19:12:18.910] [INFO    ] [__main__                 ] [check_database:234] Найдено таблиц: 7
[2025-10-11 19:12:18.911] [INFO    ] [__main__                 ] [check_database:241]   - alembic_version (0 записей)
[2025-10-11 19:12:18.912] [INFO    ] [__main__                 ] [check_database:241]   - audit_logs (0 записей)
[2025-10-11 19:12:18.912] [INFO    ] [__main__                 ] [check_database:241]   - idempotency_cache (0 записей)
[2025-10-11 19:12:18.913] [INFO    ] [__main__                 ] [check_database:241]   - market_data_snapshots (0 записей)
[2025-10-11 19:12:18.913] [INFO    ] [__main__                 ] [check_database:241]   - orders (0 записей)
[2025-10-11 19:12:18.914] [INFO    ] [__main__                 ] [check_database:241]   - positions (0 записей)
[2025-10-11 19:12:18.914] [INFO    ] [__main__                 ] [check_database:241]   - trades (0 записей)
[2025-10-11 19:12:18.914] [INFO    ] [__main__                 ] [check_database:254] Миграции не применены
[2025-10-11 19:12:18.915] [INFO    ] [__main__                 ] [check_database:257] ✓ Проверка завершена
[2025-10-11 19:13:23.539] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 19:13:23.539] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 19:13:23.539] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 19:13:23.539] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 19:13:23.539] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 19:13:23.539] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 19:13:23.539] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 19:13:23.539] [INFO    ] [__main__                 ] [check_connection:88] Проверка подключения к базе данных...
[2025-10-11 19:13:23.539] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00017s] ()
[2025-10-11 19:13:23.616] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 19:13:23.616] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 19:13:23.616] [ERROR   ] [__main__                 ] [check_connection:128] Ошибка подключения: Textual SQL expression 'SELECT version()' should be explicitly declared as text('SELECT version()')
Traceback (most recent call last):
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\backend\scripts\init_database.py", line 95, in check_connection
    result = await session.execute("SELECT version()")
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2147, in _execute_internal
    statement = coercions.expect(roles.StatementRole, statement)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 395, in expect
    resolved = impl._literal_coercion(
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 621, in _literal_coercion
    return self._text_coercion(element, argname, **kw)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 614, in _text_coercion
    return _no_text_coercion(element, argname)
  File "C:\Users\1q\PycharmProjects\Bot_ver3_stakan_new\.venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 584, in _no_text_coercion
    raise exc_cls(
sqlalchemy.exc.ArgumentError: Textual SQL expression 'SELECT version()' should be explicitly declared as text('SELECT version()')
[2025-10-11 19:13:23.616] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 19:13:23.616] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 21:28:53.527] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 21:28:53.527] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 21:28:53.527] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 21:28:53.527] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 21:28:53.527] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 21:28:53.527] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 21:28:53.527] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 21:28:53.527] [INFO    ] [__main__                 ] [main:559] ================================================================================
[2025-10-11 21:28:53.527] [INFO    ] [__main__                 ] [main:560] COMPREHENSIVE TRADING FLOW EXAMPLE
[2025-10-11 21:28:53.527] [INFO    ] [__main__                 ] [main:561] ================================================================================
[2025-10-11 21:28:53.527] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00020s] ()
[2025-10-11 21:28:53.606] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:28:53.606] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 21:28:53.606] [INFO    ] [infrastructure.resilience.circuit_breaker] [__init__:66] Circuit Breaker 'trading_example' инициализирован: failure_threshold=3, cooldown=30s
[2025-10-11 21:28:53.606] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 21:28:53.606] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 21:30:33.678] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 21:30:33.678] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 21:30:33.678] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 21:30:33.678] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 21:30:33.678] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 21:30:33.678] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 21:30:33.678] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 21:30:33.678] [INFO    ] [__main__                 ] [main:559] ================================================================================
[2025-10-11 21:30:33.678] [INFO    ] [__main__                 ] [main:560] COMPREHENSIVE TRADING FLOW EXAMPLE
[2025-10-11 21:30:33.678] [INFO    ] [__main__                 ] [main:561] ================================================================================
[2025-10-11 21:30:33.678] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00018s] ()
[2025-10-11 21:30:33.741] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:30:33.741] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 21:30:33.741] [INFO    ] [infrastructure.resilience.circuit_breaker] [__init__:66] Circuit Breaker 'trading_example' инициализирован: failure_threshold=3, cooldown=30s
[2025-10-11 21:30:33.741] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 21:30:33.741] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
[2025-10-11 21:31:22.945] [INFO    ] [core.logger              ] [setup_logging:150] ================================================================================
[2025-10-11 21:31:22.945] [INFO    ] [core.logger              ] [setup_logging:151] Scalping Trading Bot v1.0.0
[2025-10-11 21:31:22.945] [INFO    ] [core.logger              ] [setup_logging:152] Система логирования инициализирована: уровень=INFO
[2025-10-11 21:31:22.945] [INFO    ] [core.logger              ] [setup_logging:153] Режим работы: ОТЛАДКА
[2025-10-11 21:31:22.960] [INFO    ] [core.logger              ] [setup_logging:154] Bybit режим: MAINNET
[2025-10-11 21:31:22.960] [INFO    ] [core.logger              ] [setup_logging:155] Торговые пары: ['BTCUSDT', 'ETHUSDT', 'SOLUSDT']
[2025-10-11 21:31:22.960] [INFO    ] [core.logger              ] [setup_logging:156] ================================================================================
[2025-10-11 21:31:22.961] [INFO    ] [__main__                 ] [main:559] ================================================================================
[2025-10-11 21:31:22.962] [INFO    ] [__main__                 ] [main:560] COMPREHENSIVE TRADING FLOW EXAMPLE
[2025-10-11 21:31:22.962] [INFO    ] [__main__                 ] [main:561] ================================================================================
[2025-10-11 21:31:22.962] [INFO    ] [database.connection      ] [initialize:43] Инициализация подключения к PostgreSQL...
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select pg_catalog.version()
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] select current_schema()
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] show standard_conforming_strings
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [raw sql] ()
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT 1
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00019s] ()
[2025-10-11 21:31:23.023] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:23.023] [INFO    ] [database.connection      ] [initialize:79] ✓ База данных подключена успешно
[2025-10-11 21:31:23.023] [INFO    ] [infrastructure.resilience.circuit_breaker] [__init__:66] Circuit Breaker 'trading_example' инициализирован: failure_threshold=3, cooldown=30s
[2025-10-11 21:31:23.023] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: full_trade_cycle | symbol=BTCUSDT, side=Buy
[2025-10-11 21:31:23.023] [INFO    ] [__main__                 ] [execute_full_trade_cycle:90] [BTCUSDT] → ШАГ 1: Анализ рынка
[2025-10-11 21:31:23.023] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: analyze_market | symbol=BTCUSDT
[2025-10-11 21:31:23.123] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: analyze_market (100.32ms)
[2025-10-11 21:31:23.123] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: generate_signal | symbol=BTCUSDT, side=Buy
[2025-10-11 21:31:23.186] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: generate_signal (62.53ms)
[2025-10-11 21:31:23.186] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: calculate_indicators | symbol=BTCUSDT
[2025-10-11 21:31:23.249] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: calculate_indicators (63.17ms)
[2025-10-11 21:31:23.249] [INFO    ] [__main__                 ] [execute_full_trade_cycle:115] [BTCUSDT] → ШАГ 2: Размещение ордера
[2025-10-11 21:31:23.249] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: place_order_protected | symbol=BTCUSDT
[2025-10-11 21:31:23.280] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:23.299] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT idempotency_cache.id, idempotency_cache.idempotency_key, idempotency_cache.operation, idempotency_cache.result, idempotency_cache.success, idempotency_cache.error, idempotency_cache.created_at, idempotency_cache.expires_at 
FROM idempotency_cache 
WHERE idempotency_cache.idempotency_key = $1::VARCHAR AND idempotency_cache.expires_at > $2::TIMESTAMP WITHOUT TIME ZONE
[2025-10-11 21:31:23.299] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00046s] ('c888c671380818ef9cc6618fc5421770f20902d7050158c569fc00680bb91757', datetime.datetime(2025, 10, 11, 14, 31, 23, 249332))
[2025-10-11 21:31:23.299] [INFO    ] [domain.services.idempotency_service] [check_idempotency:118] Найдена идемпотентная операция: place_order, ключ: c888c671380818ef...
[2025-10-11 21:31:23.299] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:23.299] [INFO    ] [__main__                 ] [_place_order_with_protection:303] Возврат кэшированного результата: BTCUSDT_Buy_20251011143123249332_55c753d1
[2025-10-11 21:31:23.299] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: place_order_protected (49.80ms)
[2025-10-11 21:31:23.299] [INFO    ] [__main__                 ] [execute_full_trade_cycle:147] [BTCUSDT] → ШАГ 3: Создание позиции
[2025-10-11 21:31:23.299] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: create_position | symbol=BTCUSDT
[2025-10-11 21:31:23.342] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:23.342] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] INSERT INTO positions (id, symbol, side, status, quantity, entry_price, exit_price, current_price, stop_loss, take_profit, trailing_stop, unrealized_pnl, realized_pnl, opened_at, closed_at, updated_at, entry_signal, entry_market_data, entry_indicators, entry_reason, exit_reason, version) VALUES ($1::UUID, $2::VARCHAR, $3::orderside, $4::positionstatus, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT, $9::FLOAT, $10::FLOAT, $11::FLOAT, $12::FLOAT, $13::FLOAT, $14::TIMESTAMP WITHOUT TIME ZONE, $15::TIMESTAMP WITHOUT TIME ZONE, $16::TIMESTAMP WITHOUT TIME ZONE, $17::JSONB, $18::JSONB, $19::JSONB, $20::VARCHAR, $21::VARCHAR, $22::INTEGER)
[2025-10-11 21:31:23.342] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00047s] (UUID('4342a876-f191-47ff-9b3c-a8a8691cf047'), 'BTCUSDT', 'BUY', 'OPENING', 0.001, 50000.0, None, 50000.0, 49000.0, 52500.0, None, 0.0, None, datetime.datetime(2025, 10, 11, 14, 31, 23, 299135), None, datetime.datetime(2025, 10, 11, 14, 31, 23, 299135), '{"type": "momentum", "strength": 0.85, "direction": "Buy", "confidence": 0.9}', '{"price": 50000.0, "imbalance": 0.75, "spread": 0.5, "volume_bid": 1000.0, "volume_ask": 800.0}', '{"rsi": 55, "macd": 0.05, "ema_20": 49900.0, "ema_50": 49500.0}', 'Entry based on momentum strategy', None, 1)
[2025-10-11 21:31:23.356] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:23.399] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:23.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:23.399] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00047s] (UUID('4342a876-f191-47ff-9b3c-a8a8691cf047'),)
[2025-10-11 21:31:23.409] [INFO    ] [infrastructure.repositories.position_repository] [create:76] Создана позиция: 4342a876-f191-47ff-9b3c-a8a8691cf047 | BTCUSDT Buy 0.001 @ 50000.0
[2025-10-11 21:31:23.409] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:23.412] [INFO    ] [domain.state_machines.position_fsm] [_log_transition:119] Position 4342a876-f191-47ff-9b3c-a8a8691cf047 переход: Opening -> OPEN (trigger: confirm_open)
[2025-10-11 21:31:23.412] [INFO    ] [transitions.core         ] [callbacks:1176] Executed callback '_log_transition'
[2025-10-11 21:31:23.412] [INFO    ] [transitions.core         ] [exit:137] Finished processing state OPENING exit callbacks.
[2025-10-11 21:31:23.412] [INFO    ] [transitions.core         ] [enter:131] Finished processing state OPEN enter callbacks.
[2025-10-11 21:31:23.412] [INFO    ] [domain.state_machines.position_fsm] [_on_opened:127] Position 4342a876-f191-47ff-9b3c-a8a8691cf047 успешно открыта
[2025-10-11 21:31:23.412] [INFO    ] [transitions.core         ] [callbacks:1176] Executed callback '_on_opened'
[2025-10-11 21:31:23.452] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:23.452] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:23.452] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00034s] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:23.452] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:23.500] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:23.500] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET status=$1::positionstatus, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE, version=$3::INTEGER WHERE positions.id = $4::UUID AND positions.version = $5::INTEGER
[2025-10-11 21:31:23.500] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00029s] ('OPEN', datetime.datetime(2025, 10, 11, 14, 31, 23, 452776), 2, '4342a876-f191-47ff-9b3c-a8a8691cf047', 1)
[2025-10-11 21:31:23.500] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:23.500] [INFO    ] [infrastructure.repositories.position_repository] [update_status:187] Обновлен статус позиции 4342a876-f191-47ff-9b3c-a8a8691cf047: Open
[2025-10-11 21:31:23.546] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:23.546] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] INSERT INTO audit_logs (id, action, entity_type, entity_id, old_value, new_value, changes, reason, user_id, trace_id, success, error_message, timestamp, context) VALUES ($1::UUID, $2::auditaction, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::JSONB, $7::JSONB, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::BOOLEAN, $12::VARCHAR, $13::TIMESTAMP WITHOUT TIME ZONE, $14::JSONB)
[2025-10-11 21:31:23.546] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00055s] (UUID('1d715c0a-36d4-45e0-8186-3c2a614730be'), 'POSITION_OPEN', 'Position', '4342a876-f191-47ff-9b3c-a8a8691cf047', 'null', '{"symbol": "BTCUSDT", "side": "Buy", "quantity": 0.001, "entry_price": 50000.0}', 'null', None, None, 'beae7501-10e2-468f-99da-4684faa81015', True, None, datetime.datetime(2025, 10, 11, 14, 31, 23, 500051), 'null')
[2025-10-11 21:31:23.562] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:23.562] [INFO    ] [__main__                 ] [_create_and_track_position:447] ✓ Позиция открыта: 4342a876-f191-47ff-9b3c-a8a8691cf047
[2025-10-11 21:31:23.562] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: create_position (263.42ms)
[2025-10-11 21:31:23.562] [INFO    ] [__main__                 ] [execute_full_trade_cycle:179] [BTCUSDT] → ШАГ 4: Мониторинг позиции
[2025-10-11 21:31:23.562] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: monitor_position | position_id=4342a876-f191-47ff-9b3c-a8a8691cf047
[2025-10-11 21:31:23.562] [INFO    ] [__main__                 ] [_monitor_position:462] Мониторинг позиции 4342a876-f191-47ff-9b3c-a8a8691cf047 в течение 10s
[2025-10-11 21:31:24.617] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:24.617] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:24.617] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 1.168s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:24.617] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:24.664] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:24.664] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:24.664] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00043s] (50000.0, 0.0, datetime.datetime(2025, 10, 11, 14, 31, 24, 617294), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:24.664] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:25.703] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:25.703] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:25.703] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 2.264s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:25.719] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:25.767] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:25.767] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:25.767] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 1.096s ago] (50010.0, 0.01, datetime.datetime(2025, 10, 11, 14, 31, 25, 719372), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:25.767] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:26.931] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:26.931] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:26.931] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 3.485s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:26.931] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:26.978] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:26.978] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:26.978] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 2.316s ago] (50020.0, 0.02, datetime.datetime(2025, 10, 11, 14, 31, 26, 946939), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:26.978] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:28.015] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:28.015] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:28.030] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 4.576s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:28.030] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:28.078] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:28.078] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:28.078] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 3.409s ago] (50030.0, 0.03, datetime.datetime(2025, 10, 11, 14, 31, 28, 30835), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:28.078] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:29.131] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:29.131] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:29.131] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 5.678s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:29.131] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:29.179] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:29.179] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:29.179] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 4.511s ago] (50040.0, 0.04, datetime.datetime(2025, 10, 11, 14, 31, 29, 131817), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:29.179] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:30.234] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:30.234] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:30.234] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 6.781s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:30.234] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:30.281] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:30.281] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:30.281] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 5.618s ago] (50050.0, 0.05, datetime.datetime(2025, 10, 11, 14, 31, 30, 234806), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:30.281] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:31.335] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:31.335] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:31.335] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 7.886s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:31.335] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:31.382] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:31.382] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:31.382] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 6.717s ago] (50060.0, 0.06, datetime.datetime(2025, 10, 11, 14, 31, 31, 335024), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:31.382] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:32.438] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:32.439] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:32.439] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 8.985s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:32.444] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:32.475] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:32.475] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:32.475] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 7.818s ago] (50070.0, 0.07, datetime.datetime(2025, 10, 11, 14, 31, 32, 444270), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:32.491] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:33.658] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:33.658] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:33.658] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 10.21s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:33.674] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:33.709] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:33.709] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:33.709] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 9.047s ago] (50080.0, 0.08, datetime.datetime(2025, 10, 11, 14, 31, 33, 674528), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:33.709] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:34.761] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:34.761] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:34.775] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 11.32s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:34.775] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:34.822] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:34.822] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET current_price=$1::FLOAT, unrealized_pnl=$2::FLOAT, updated_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE positions.id = $4::UUID
[2025-10-11 21:31:34.822] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 10.15s ago] (50090.0, 0.09, datetime.datetime(2025, 10, 11, 14, 31, 34, 775624), '4342a876-f191-47ff-9b3c-a8a8691cf047')
[2025-10-11 21:31:34.825] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:34.854] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:34.869] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:34.869] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 11.42s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:34.869] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:34.869] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: monitor_position (11307.38ms)
[2025-10-11 21:31:34.869] [INFO    ] [__main__                 ] [execute_full_trade_cycle:197] [BTCUSDT] → ШАГ 5: Закрытие позиции
[2025-10-11 21:31:34.979] [INFO    ] [core.trace_context       ] [trace_operation:151] [trace_id=beae7501-10e2-468f-99da-4684faa81015] → Начало операции: close_position | position_id=4342a876-f191-47ff-9b3c-a8a8691cf047
[2025-10-11 21:31:35.026] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:35.026] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:35.027] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 11.57s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:35.027] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:35.027] [INFO    ] [domain.state_machines.position_fsm] [_log_transition:119] Position 4342a876-f191-47ff-9b3c-a8a8691cf047 переход: Open -> CLOSING (trigger: start_close)
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [callbacks:1176] Executed callback '_log_transition'
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [exit:137] Finished processing state OPEN exit callbacks.
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [enter:131] Finished processing state CLOSING enter callbacks.
[2025-10-11 21:31:35.027] [INFO    ] [domain.state_machines.position_fsm] [_on_closing:131] Position 4342a876-f191-47ff-9b3c-a8a8691cf047 начинает закрываться
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [callbacks:1176] Executed callback '_on_closing'
[2025-10-11 21:31:35.027] [INFO    ] [domain.state_machines.position_fsm] [_log_transition:119] Position 4342a876-f191-47ff-9b3c-a8a8691cf047 переход: Open -> CLOSED (trigger: confirm_close)
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [callbacks:1176] Executed callback '_log_transition'
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [exit:137] Finished processing state CLOSING exit callbacks.
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [enter:131] Finished processing state CLOSED enter callbacks.
[2025-10-11 21:31:35.027] [INFO    ] [domain.state_machines.position_fsm] [_on_closed:135] Position 4342a876-f191-47ff-9b3c-a8a8691cf047 закрыта
[2025-10-11 21:31:35.027] [INFO    ] [transitions.core         ] [callbacks:1176] Executed callback '_on_closed'
[2025-10-11 21:31:35.075] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:35.075] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:35.075] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 11.62s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:35.075] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:35.126] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:35.126] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] UPDATE positions SET status=$1::positionstatus, exit_price=$2::FLOAT, realized_pnl=$3::FLOAT, closed_at=$4::TIMESTAMP WITHOUT TIME ZONE, updated_at=$5::TIMESTAMP WITHOUT TIME ZONE, exit_signal=$6::JSONB, exit_market_data=$7::JSONB, exit_indicators=$8::JSONB, exit_reason=$9::VARCHAR, version=$10::INTEGER WHERE positions.id = $11::UUID AND positions.version = $12::INTEGER
[2025-10-11 21:31:35.126] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [generated in 0.00036s] ('CLOSED', 50100.0, 0.1, datetime.datetime(2025, 10, 11, 14, 31, 35, 75294), datetime.datetime(2025, 10, 11, 14, 31, 35, 75294), '{"type": "take_profit", "strength": 0.9}', '{"price": 50100.0, "imbalance": 0.4}', '{"rsi": 70, "macd": -0.02}', 'Take profit target reached', 3, '4342a876-f191-47ff-9b3c-a8a8691cf047', 2)
[2025-10-11 21:31:35.137] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:35.137] [INFO    ] [infrastructure.repositories.position_repository] [update_status:187] Обновлен статус позиции 4342a876-f191-47ff-9b3c-a8a8691cf047: Closed
[2025-10-11 21:31:35.168] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:35.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] SELECT positions.id, positions.symbol, positions.side, positions.status, positions.quantity, positions.entry_price, positions.exit_price, positions.current_price, positions.stop_loss, positions.take_profit, positions.trailing_stop, positions.unrealized_pnl, positions.realized_pnl, positions.opened_at, positions.closed_at, positions.updated_at, positions.entry_signal, positions.exit_signal, positions.entry_market_data, positions.exit_market_data, positions.entry_indicators, positions.exit_indicators, positions.entry_reason, positions.exit_reason, positions.version, positions.metadata_json 
FROM positions 
WHERE positions.id = $1::UUID
[2025-10-11 21:31:35.184] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 11.73s ago] ('4342a876-f191-47ff-9b3c-a8a8691cf047',)
[2025-10-11 21:31:35.184] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:35.231] [INFO    ] [sqlalchemy.engine.Engine ] [_begin_impl:1094] BEGIN (implicit)
[2025-10-11 21:31:35.231] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1899] INSERT INTO audit_logs (id, action, entity_type, entity_id, old_value, new_value, changes, reason, user_id, trace_id, success, error_message, timestamp, context) VALUES ($1::UUID, $2::auditaction, $3::VARCHAR, $4::VARCHAR, $5::JSONB, $6::JSONB, $7::JSONB, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::BOOLEAN, $12::VARCHAR, $13::TIMESTAMP WITHOUT TIME ZONE, $14::JSONB)
[2025-10-11 21:31:35.231] [INFO    ] [sqlalchemy.engine.Engine ] [_exec_single_context:1904] [cached since 11.68s ago] (UUID('10bf4e08-f765-41d6-8356-21c8b9943c11'), 'POSITION_CLOSE', 'Position', '4342a876-f191-47ff-9b3c-a8a8691cf047', 'null', '{"exit_price": 50100.0, "realized_pnl": 0.1}', 'null', 'Take profit target reached', None, 'beae7501-10e2-468f-99da-4684faa81015', True, None, datetime.datetime(2025, 10, 11, 14, 31, 35, 184208), '{"exit_signal": {"type": "take_profit", "strength": 0.9}, "exit_indicators": {"rsi": 70, "macd": -0.02}}')
[2025-10-11 21:31:35.231] [INFO    ] [sqlalchemy.engine.Engine ] [_commit_impl:1143] COMMIT
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [_close_position_with_audit:547] ✓ Позиция закрыта: 4342a876-f191-47ff-9b3c-a8a8691cf047 | PnL: 0.10
[2025-10-11 21:31:35.231] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: close_position (251.82ms)
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [execute_full_trade_cycle:224] ✓ [BTCUSDT] Полный цикл сделки завершен | PnL: 0.10
[2025-10-11 21:31:35.231] [INFO    ] [core.trace_context       ] [trace_operation:162] [trace_id=beae7501-10e2-468f-99da-4684faa81015] ✓ Операция завершена: full_trade_cycle (12208.50ms)
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:577] ================================================================================
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:578] РЕЗУЛЬТАТЫ
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:579] ================================================================================
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:580] Trade ID: beae7501-10e2-468f-99da-4684faa81015
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:581] Success: True
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:582] Steps completed: 5
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:585] Realized PnL: 0.10
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:586] Duration: 11.78s
[2025-10-11 21:31:35.231] [INFO    ] [__main__                 ] [main:588] ================================================================================
[2025-10-11 21:31:35.231] [INFO    ] [database.connection      ] [close:110] Закрытие подключения к БД...
[2025-10-11 21:31:35.231] [INFO    ] [database.connection      ] [close:113] ✓ БД отключена
