# üìä –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ MLflow –¥–ª—è Trading Bot

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã](#–æ—Ç–≤–µ—Ç—ã-–Ω–∞-–≤–∞—à–∏-–≤–æ–ø—Ä–æ—Å—ã)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MLflow –≤ –ø—Ä–æ–µ–∫—Ç–µ](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-mlflow-–≤-–ø—Ä–æ–µ–∫—Ç–µ)
3. [–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ](#—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã-–∏-–∏—Ö-–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ)
4. [–†–∞–±–æ—Ç–∞ —Å –º–æ–¥–µ–ª—è–º–∏](#—Ä–∞–±–æ—Ç–∞-—Å-–º–æ–¥–µ–ª—è–º–∏)
5. [–ü–æ–∏—Å–∫ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π](#–ø–æ–∏—Å–∫-–∏-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π)
6. [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã)

---

## –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã

### 1. –ú–æ–∂–Ω–æ –ª–∏ —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å MLflow –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ?

**–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ—Ç.** MLflow UI –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é:

- MLflow ‚Äî —ç—Ç–æ open-source –ø—Ä–æ–µ–∫—Ç –æ—Ç Databricks —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º —Ç–æ–ª—å–∫–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
- –ù–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∂—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω –≤ React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**

1. **–ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ –≤ Chrome/Edge (–ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí "–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ —Ä—É—Å—Å–∫–∏–π")

2. **–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥** ‚Äî –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–≤–µ—Ä—Ö MLflow API:
   ```python
   # –ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ UI
   from mlflow.tracking import MlflowClient
   client = MlflowClient()

   # –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
   experiments = client.search_experiments()

   # –ü–æ–ª—É—á–∏—Ç—å runs
   runs = client.search_runs(experiment_ids=["1"])
   ```

3. **Streamlit –¥–∞—à–±–æ—Ä–¥** ‚Äî –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º (—Å–º. –ø—Ä–∏–º–µ—Ä –≤ –∫–æ–Ω—Ü–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞)

---

### 2. –ü–æ—á–µ–º—É tags –ø—É—Å—Ç—ã–µ –≤ Models?

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ —Ç–µ–≥–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è!

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–¥ –≤ `training_orchestrator.py:393-397`:

```python
# –¢–µ–∫—É—â–∏–π –∫–æ–¥ - tags –ù–ï –ü–ï–†–ï–î–ê–Æ–¢–°–Ø!
mlflow_version = self.mlflow_tracker.register_model(
    model_uri=model_uri,
    model_name=model_name,
    description=f"Trained model - {run_name}"
    # ‚Üê –ù–ï–¢ tags!
)
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

---

### 3. –ü–æ—á–µ–º—É schema inputs/outputs –ø—É—Å—Ç—ã–µ?

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è `signature`!

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–¥ –≤ `training_orchestrator.py:353-359`:

```python
# –¢–µ–∫—É—â–∏–π –∫–æ–¥ - signature –ù–ï –ü–ï–†–ï–î–ê–Å–¢–°–Ø!
model_uri = self.mlflow_tracker.log_model(
    model=model,
    model_name=model_name,
    artifacts={
        "metadata": str(metadata_path)
    }
    # ‚Üê –ù–ï–¢ signature –∏ input_example!
)
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å `signature` –∏ `input_example` –ø—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏.

---

### 4. –ü–æ—á–µ–º—É "No traces recorded" –≤–µ–∑–¥–µ?

**–ü—Ä–∏—á–∏–Ω–∞:** MLflow Tracing ‚Äî —ç—Ç–æ **–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è MLflow 2.12+** –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ LLM/GenAI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

Tracing –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:
- LLM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (ChatGPT, Claude –∏ —Ç.–¥.)
- LangChain pipelines
- RAG —Å–∏—Å—Ç–µ–º

**–î–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ (PyTorch –º–æ–¥–µ–ª–∏) tracing –ù–ï –ù–£–ñ–ï–ù!**

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —á—Ç–æ traces –ø—É—Å—Ç—ã–µ ‚Äî –≤–∞—à –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π ML tracking (runs, metrics, params), –∞ –Ω–µ GenAI tracing.

---

### 5. –ü–æ—á–µ–º—É –º–æ–¥–µ–ª–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö?

| –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç | –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ö–æ–¥ |
|-------------|------------------|-----|
| `trading_bot_ml` | Default —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é) | `config.py` |
| `model_training` | `TrainingOrchestrator.train_model()` | `training_orchestrator.py:123` |
| `auto_retraining` | `RetrainingPipeline` –ø—Ä–∏ –∞–≤—Ç–æ–æ–±—É—á–µ–Ω–∏–∏ | `retraining_pipeline.py:112` |

**–ü—Ä–∏—á–∏–Ω–∞:** –†–∞–∑–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã:
- –ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –æ–±—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `TrainingOrchestrator` ‚Üí `model_training`
- –ï—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ ‚Üí `auto_retraining`
- `trading_bot_ml` ‚Äî legacy default, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MLflow –≤ –ø—Ä–æ–µ–∫—Ç–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     MLflow –≤ Trading Bot                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ   PostgreSQL    ‚îÇ    ‚îÇ         –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞        ‚îÇ‚îÇ
‚îÇ  ‚îÇ   (Backend)     ‚îÇ    ‚îÇ          (–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã)            ‚îÇ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Experiments   ‚îÇ    ‚îÇ ./mlruns/artifacts/             ‚îÇ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Runs          ‚îÇ    ‚îÇ   ‚îî‚îÄ‚îÄ {experiment_id}/          ‚îÇ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Params        ‚îÇ    ‚îÇ       ‚îî‚îÄ‚îÄ {run_id}/             ‚îÇ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Metrics       ‚îÇ    ‚îÇ           ‚îú‚îÄ‚îÄ model.pt          ‚îÇ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Tags          ‚îÇ    ‚îÇ           ‚îú‚îÄ‚îÄ model.onnx        ‚îÇ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Model Registry‚îÇ    ‚îÇ           ‚îî‚îÄ‚îÄ metadata.json     ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ                    MLflowTracker                        ‚îÇ‚îÇ
‚îÇ  ‚îÇ  (backend/ml_engine/mlflow_integration/mlflow_tracker.py)‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ start_run()      - –ù–∞—á–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç               ‚îÇ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ log_params()     - –ó–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã               ‚îÇ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ log_metrics()    - –ó–∞–ø–∏—Å–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏                 ‚îÇ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ log_model()      - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–µ–ª—å                 ‚îÇ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ register_model() - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Model Registry‚îÇ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ end_run()        - –ó–∞–≤–µ—Ä—à–∏—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç            ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–§–∞–π–ª `.env`:**
```bash
MLFLOW_TRACKING_URI=postgresql://trading_bot:robocop@localhost:5432/mlflow_tracking
MLFLOW_ARTIFACT_LOCATION=./mlruns/artifacts
MLFLOW_EXPERIMENT_NAME=trading_bot_ml
```

**–ó–∞–ø—É—Å–∫ UI:**
```bash
python start_mlflow_ui.py
# –û—Ç–∫—Ä–æ–µ—Ç—Å—è: http://localhost:5000
```

---

## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

### 1. `trading_bot_ml` (Default)
- **–°—Ç–∞—Ç—É—Å:** Legacy, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—â–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
- **–°–æ–∑–¥–∞—ë—Ç—Å—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ MLflowTracker –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤

### 2. `model_training`
- **–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω—ã–π
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†—É—á–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TrainingOrchestrator
- **–°–æ–∑–¥–∞—ë—Ç—Å—è:** –í `training_orchestrator.py:123`
- **–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç:**
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ (model_*, trainer_*)
  - –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è (train_loss, val_accuracy, etc.)
  - –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (test_accuracy, test_f1)
  - PyTorch –º–æ–¥–µ–ª—å + ONNX —ç–∫—Å–ø–æ—Ä—Ç
  - Metadata JSON

### 3. `auto_retraining`
- **–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω—ã–π
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
- **–°–æ–∑–¥–∞—ë—Ç—Å—è:** –í `retraining_pipeline.py:112`
- **–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç:**
  - Trigger –ø—Ä–∏—á–∏–Ω–∞ (scheduled, drift, performance_drop)
  - Walk-forward validation —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  - –ê–≤—Ç–æ-–ø—Ä–æ–º–æ—É—à–µ–Ω –≤ production

---

## –†–∞–±–æ—Ç–∞ —Å –º–æ–¥–µ–ª—è–º–∏

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –º–æ–¥–µ–ª–∏

```
1. Training          2. Logging           3. Registry         4. Production
   ‚Üì                    ‚Üì                    ‚Üì                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ train()  ‚îÇ ‚îÄ‚îÄ‚îÄ‚Üí  ‚îÇ log_model()  ‚îÇ ‚îÄ‚Üí ‚îÇregister_model‚îÇ ‚îÄ‚Üí ‚îÇ  promote_to  ‚îÇ
‚îÇ          ‚îÇ       ‚îÇ              ‚îÇ    ‚îÇ              ‚îÇ    ‚îÇ  production  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ                    ‚îÇ                   ‚îÇ                   ‚îÇ
    ‚ñº                    ‚ñº                   ‚ñº                   ‚ñº
 HybridCNN           runs:/{id}/         Model v1,v2...      Active model
 LSTM –º–æ–¥–µ–ª—å         hybrid_cnn_lstm     –≤ Registry          –¥–ª—è inference
```

### Model Registry –≤ –ø—Ä–æ–µ–∫—Ç–µ

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¥–≤–∞ —Ä–µ–µ—Å—Ç—Ä–∞ –º–æ–¥–µ–ª–µ–π**:

1. **MLflow Model Registry** ‚Äî —Ö—Ä–∞–Ω–∏—Ç –≤–µ—Ä—Å–∏–∏ –≤ PostgreSQL
2. **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π ModelRegistry** (`model_registry.py`) ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç production —Å—Ç–∞—Ç—É—Å–∞–º–∏

```python
# MLflow Registry
mlflow.register_model(model_uri, "hybrid_cnn_lstm")

# –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Registry (–±–æ–ª–µ–µ –±–æ–≥–∞—Ç—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
await model_registry.register_model(
    name="hybrid_cnn_lstm",
    version=timestamp,
    model_path=model_path,
    metrics=test_metrics
)
```

---

## –ü–æ–∏—Å–∫ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### –ß–µ—Ä–µ–∑ MLflow UI (http://localhost:5000)

1. **Experiments** ‚Äî –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç
2. **Runs** ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–ø—É—Å–∫–æ–≤
3. **Compare** ‚Äî –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ runs –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
4. **Chart** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
5. **Models** ‚Äî –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

### –ß–µ—Ä–µ–∑ –∫–æ–¥

```python
from backend.ml_engine.mlflow_integration import get_mlflow_tracker

tracker = get_mlflow_tracker(experiment_name="model_training")

# –ü–æ–ª—É—á–∏—Ç—å –ª—É—á—à–∏–π run –ø–æ –º–µ—Ç—Ä–∏–∫–µ
best_run = tracker.get_best_run(metric="val_accuracy", order="DESC")
print(f"–õ—É—á—à–∏–π run: {best_run['run_id']}")
print(f"Accuracy: {best_run['metrics.val_accuracy']}")

# –ü–æ–∏—Å–∫ runs –ø–æ —Ñ–∏–ª—å—Ç—Ä—É
runs = tracker.search_runs(
    filter_string="metrics.val_accuracy > 0.7",
    order_by=["metrics.val_f1 DESC"],
    max_results=10
)

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å
model = tracker.load_model("models:/hybrid_cnn_lstm/latest")
```

### –§–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ MLflow

```python
# –ü–æ –º–µ—Ç—Ä–∏–∫–∞–º
"metrics.accuracy > 0.85"
"metrics.val_loss < 0.5"

# –ü–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
"params.model_hidden_size = '128'"
"params.trainer_epochs = '50'"

# –ü–æ —Ç–µ–≥–∞–º
"tags.training_mode = 'manual'"
"tags.trigger = 'scheduled'"

# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
"metrics.accuracy > 0.8 AND params.trainer_epochs = '50'"
```

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–ª–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```python
import asyncio
from backend.ml_engine.training_orchestrator import TrainingOrchestrator

async def train():
    orchestrator = TrainingOrchestrator()

    result = await orchestrator.train_model(
        model_name="hybrid_cnn_lstm",
        run_name="my_experiment_v1",
        export_onnx=True,
        auto_promote=True,
        min_accuracy_for_promotion=0.75
    )

    print(f"–£—Å–ø–µ—Ö: {result['success']}")
    print(f"–í–µ—Ä—Å–∏—è: {result['version']}")
    print(f"Test Accuracy: {result['test_metrics'].get('accuracy', 0):.4f}")

asyncio.run(train())
```

### –ü—Ä–∏–º–µ—Ä 2: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```python
from mlflow.tracking import MlflowClient
import pandas as pd

client = MlflowClient()

# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ runs –∏–∑ model_training
runs = client.search_runs(
    experiment_ids=["2"],  # model_training ID
    filter_string="",
    order_by=["metrics.test_accuracy DESC"],
    max_results=20
)

# –°–æ–∑–¥–∞—Ç—å —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
data = []
for run in runs:
    data.append({
        "run_id": run.info.run_id[:8],
        "name": run.info.run_name,
        "accuracy": run.data.metrics.get("test_accuracy", 0),
        "f1": run.data.metrics.get("test_f1", 0),
        "epochs": run.data.params.get("trainer_epochs", "?"),
        "lr": run.data.params.get("trainer_learning_rate", "?")
    })

df = pd.DataFrame(data)
print(df.to_string())
```

### –ü—Ä–∏–º–µ—Ä 3: REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ API –±–æ—Ç–∞
curl http://localhost:8000/api/ml-management/models

# –ü–æ–ª—É—á–∏—Ç—å MLflow runs
curl http://localhost:8000/api/ml-management/mlflow/runs

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
curl -X POST http://localhost:8000/api/ml-management/train \
  -H "Content-Type: application/json" \
  -d '{"epochs": 50, "batch_size": 64}'
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ó–∞–ø—É—Å–∫ MLflow UI
```bash
python start_mlflow_ui.py
# –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:
mlflow ui --backend-store-uri postgresql://trading_bot:robocop@localhost:5432/mlflow_tracking \
          --default-artifact-root ./mlruns/artifacts \
          --host 0.0.0.0 --port 5000
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
```bash
python test_mlflow_postgres.py
```

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ CLI
```bash
# –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ
python -m backend.ml_engine.training_orchestrator --epochs 50

# –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
python -m backend.ml_engine.training_orchestrator \
  --epochs 100 \
  --batch-size 128 \
  --lr 0.0005 \
  --date-range 60
```

---

## –ì–ª–æ—Å—Å–∞—Ä–∏–π MLflow

| –¢–µ—Ä–º–∏–Ω | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| **Experiment** | –ì—Ä—É–ø–ø–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö runs (–∫–∞–∫ –ø–∞–ø–∫–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤) |
| **Run** | –û–¥–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ —Å–≤–æ–∏–º–∏ params/metrics |
| **Artifact** | –§–∞–π–ª (–º–æ–¥–µ–ª—å, –≥—Ä–∞—Ñ–∏–∫, JSON) —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å run |
| **Metric** | –ß–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (accuracy, loss) |
| **Parameter** | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—É—á–µ–Ω–∏—è (epochs, lr, batch_size) |
| **Tag** | –ú–µ—Ç–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ |
| **Model Registry** | –•—Ä–∞–Ω–∏–ª–∏—â–µ –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–µ–π |
| **Model Version** | –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏ –≤ Registry |
| **Model Stage** | –°—Ç–∞–¥–∏—è –º–æ–¥–µ–ª–∏ (Staging, Production, Archived) ‚Äî **DEPRECATED** |

---

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–õ–∏–º–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:** 500 —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
2. **NaN –º–µ—Ç—Ä–∏–∫–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ 0.0
3. **–î—É–±–ª–∏–∫–∞—Ç—ã –∫–ª—é—á–µ–π:** –ò–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏
4. **Model Stages:** Deprecated –Ω–∞—á–∏–Ω–∞—è —Å MLflow 2.9.0 (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Registry)

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2025-12-16*
*–ü—Ä–æ–µ–∫—Ç: Trading Bot ML Infrastructure*
